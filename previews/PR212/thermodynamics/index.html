<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermodynamics ¬∑ Breeze</title><meta name="title" content="Thermodynamics ¬∑ Breeze"/><meta property="og:title" content="Thermodynamics ¬∑ Breeze"/><meta property="twitter:title" content="Thermodynamics ¬∑ Breeze"/><meta name="description" content="Documentation for Breeze."/><meta property="og:description" content="Documentation for Breeze."/><meta property="twitter:description" content="Documentation for Breeze."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Breeze</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../literated/thermal_bubble/">Thermal bubble</a></li><li><a class="tocitem" href="../literated/cloudy_kelvin_helmholtz/">Cloudy Kelvin-Helmholtz instability</a></li></ul></li><li class="is-active"><a class="tocitem" href>Thermodynamics</a><ul class="internal"><li><a class="tocitem" href="#&quot;Moist&quot;-thermodynamic-relations-for-a-four-component-mixture"><span>&quot;Moist&quot; thermodynamic relations for a four-component mixture</span></a></li><li><a class="tocitem" href="#Two-laws-for-ideal-gases"><span>Two laws for ideal gases</span></a></li><li><a class="tocitem" href="#The-gaseous-nature-of-moist-air"><span>The gaseous nature of moist air</span></a></li><li><a class="tocitem" href="#The-thermal-properties-of-moist-air"><span>The thermal properties of moist air</span></a></li><li><a class="tocitem" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-vapor-pressure"><span>The Clausius‚ÄìClapeyron relation and saturation vapor pressure</span></a></li><li><a class="tocitem" href="#Saturation-specific-humidity"><span>Saturation specific humidity</span></a></li><li><a class="tocitem" href="#Moist-static-energy"><span>Moist static energy</span></a></li><li><a class="tocitem" href="#Liquid-ice-potential-temperature"><span>Liquid-ice potential temperature</span></a></li></ul></li><li><span class="tocitem">Microphysics</span><ul><li><a class="tocitem" href="../microphysics/microphysics_overview/">Overview</a></li><li><a class="tocitem" href="../microphysics/warm_phase_saturation_adjustment/">Warm-phase saturation adjustment</a></li><li><a class="tocitem" href="../microphysics/mixed_phase_saturation_adjustment/">Mixed-phase saturation adjustment</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Microphysics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../developer/microphysics_interface/">Microphysics Interface</a></li></ul></li></ul></li><li><a class="tocitem" href="../dycore_equations_algorithms/">Dycore equations and algorithms</a></li><li><span class="tocitem">Appendix</span><ul><li><a class="tocitem" href="../appendix/notation/">Notation</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../contributing/">Contributors guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Thermodynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Thermodynamics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl/blob/main/docs/src/thermodynamics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Thermodynamics-section"><a class="docs-heading-anchor" href="#Thermodynamics-section">Atmosphere Thermodynamics</a><a id="Thermodynamics-section-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics-section" title="Permalink"></a></h1><p>Breeze implements thermodynamic relations for moist atmospheres. By &quot;moist&quot;, we mean that the atmosphere is a mixture of four components: two gas phases <em>(i)</em> &quot;dry&quot; air and <em>(ii)</em> &quot;vapor&quot;, and two &quot;condensed&quot; phases <em>(iii)</em> &quot;liquid&quot;, and <em>(iv)</em> &quot;ice&quot;. Moisture makes <em>life</em> interesting, because vapor can <em>condense</em> or <em>solidify</em> (and liquid can <em>freeze</em>) into liquid droplets and ice particles - with major consequences.</p><p>On Earth, dry air is itself a mixture of gases with fixed composition constant <a href="https://en.wikipedia.org/wiki/Molar_mass">molar mass</a>. Dry air on Earth&#39;s is mostly nitrogen, oxygen, and argon, whose combination produces the typical (and Breeze&#39;s default) dry air molar mass</p><pre><code class="language-julia hljs">using Breeze
thermo = ThermodynamicConstants()
thermo.dry_air.molar_mass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.02897</code></pre><p>The vapor, liquid, and ice components are <span>$\mathrm{H_2 O}$</span>, also known as &quot;water&quot;. Water vapor, which in Breeze has the default molar mass</p><pre><code class="language-julia hljs">thermo.vapor.molar_mass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.018015</code></pre><p>is lighter than dry air. As a result, moist, humid air is <em>lighter</em> than dry air.</p><p>Liquid in Earth&#39;s atmosphere consists of falling droplets that range from tiny, nearly-suspended mist particles to careening fat rain drops. Ice in Earth&#39;s atmosphere consists of crystals, graupel, sleet, hail and, snow.</p><h2 id="&quot;Moist&quot;-thermodynamic-relations-for-a-four-component-mixture"><a class="docs-heading-anchor" href="#&quot;Moist&quot;-thermodynamic-relations-for-a-four-component-mixture">&quot;Moist&quot; thermodynamic relations for a four-component mixture</a><a id="&quot;Moist&quot;-thermodynamic-relations-for-a-four-component-mixture-1"></a><a class="docs-heading-anchor-permalink" href="#&quot;Moist&quot;-thermodynamic-relations-for-a-four-component-mixture" title="Permalink"></a></h2><p>What does it mean that moist air is a mixture of four components? It means that the total mass <span>$\mathcal{M}$</span> of air per volume, or <em>density</em>, <span>$œÅ$</span>, can be expressed as the sum of the masses of the individual components over the total volume <span>$V$</span>,</p><p class="math-container">\[œÅ = \frac{\mathcal{M}}{V} = \frac{\mathcal{M}·µà + \mathcal{M}·µõ + \mathcal{M}À° + \mathcal{M}‚Å±}{V} = œÅ·µà + œÅ·µõ + œÅÀ° + œÅ‚Å±\]</p><p>where <span>$\mathcal{M}·µà$</span>, <span>$\mathcal{M}·µõ$</span>, <span>$\mathcal{M}À°$</span>, and <span>$\mathcal{M}‚Å±$</span> are the masses of dry air, vapor, liquid, and ice, respectively, while <span>$œÅ·µà$</span>, <span>$œÅ·µõ$</span>, <span>$œÅÀ°$</span>, and <span>$œÅ‚Å±$</span> denote their <em>fractional densities</em>. We likewise define the <em>mass fractions</em> of each component,</p><p class="math-container">\[q·µà ‚â° \frac{\mathcal{M}·µà}{\mathcal{M}} = \frac{œÅ·µà}{œÅ} , \qquad q·µõ ‚â° \frac{\mathcal{M}·µõ}{\mathcal{M}} = \frac{œÅ·µõ}{œÅ} , \qquad
qÀ° ‚â° \frac{\mathcal{M}À°}{\mathcal{M}} = \frac{œÅÀ°}{œÅ}, \qquad \text{and} \qquad q‚Å± ‚â° \frac{œÅ‚Å±}{œÅ} = \frac{\mathcal{M}‚Å±}{\mathcal{M}} .\]</p><div class="admonition is-info" id="The-significance-of-certain-superscripts-f0a920c4025399da"><header class="admonition-header">The significance of certain superscripts<a class="admonition-anchor" href="#The-significance-of-certain-superscripts-f0a920c4025399da" title="Permalink"></a></header><div class="admonition-body"><p>Throughout this documentation, superscripts are used to distinguish the components of moist air:</p><ul><li><span>$d$</span> denotes &quot;dry air&quot;</li><li><span>$v$</span> denotes &quot;vapor&quot;</li><li><span>$l$</span> denotes &quot;liquid&quot;</li><li><span>$i$</span> denotes &quot;ice&quot;</li></ul><p>A fifth super script <span>$t$</span> is used to denote &quot;total&quot;. For example, <span>$q·µà$</span> is the mass fraction of dry air, <span>$q·µõ$</span> is the mass fraction of vapor, <span>$qÀ°$</span> is the mass fraction of liquid, <span>$q‚Å±$</span> is the mass fraction of ice, and</p><p class="math-container">\[q·µó = q·µõ + qÀ° + q‚Å±\]</p><p>is the &quot;total&quot; mass fraction of the moisture components.</p></div></div><p>The liquid and ice components are not always present. For example, a model with warm-phase microphysics does not have ice. With no microphysics at all, there is no liquid <em>or</em> ice.</p><p>By definition, all of the mass fractions sum up to unity,</p><p class="math-container">\[1 = q·µà + q·µõ + qÀ° + q‚Å± ,\]</p><p>so that, using <span>$q·µó = q·µõ + qÀ° + q‚Å±$</span>, the dry air mass fraction can be diagnosed with <span>$q·µà = 1 - q·µó$</span>. The sometimes tedious bookkeeping required to correctly diagnose the effective mixture properties of moist air are facilitated by Breeze&#39;s handy <a href="../api/#Breeze.Thermodynamics.MoistureMassFractions"><code>MoistureMassFractions</code></a> abstraction. For example,</p><pre><code class="language-julia hljs">q = Breeze.Thermodynamics.MoistureMassFractions(0.01, 0.002, 1e-5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MoistureMassFractions{Float64}: 
‚îú‚îÄ‚îÄ vapor:  0.01
‚îú‚îÄ‚îÄ liquid: 0.002
‚îî‚îÄ‚îÄ ice:    1.0e-5
</code></pre><p>from which we can compute the total moisture mass fraction,</p><pre><code class="language-julia hljs">q·µó = Breeze.Thermodynamics.total_specific_moisture(q)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.01201</code></pre><p>And the dry as well,</p><pre><code class="language-julia hljs">q·µà = Breeze.Thermodynamics.dry_air_mass_fraction(q)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.98799</code></pre><p>To be sure,</p><pre><code class="language-julia hljs">q·µà + q·µó</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><h2 id="Two-laws-for-ideal-gases"><a class="docs-heading-anchor" href="#Two-laws-for-ideal-gases">Two laws for ideal gases</a><a id="Two-laws-for-ideal-gases-1"></a><a class="docs-heading-anchor-permalink" href="#Two-laws-for-ideal-gases" title="Permalink"></a></h2><p>Both dry air and vapor are modeled as ideal gases, which means that the <a href="https://en.wikipedia.org/wiki/Ideal_gas_law">ideal gas law</a> relates pressure <span>$p$</span>, temperature <span>$T$</span>, and density <span>$œÅ$</span>,</p><p class="math-container">\[p = œÅ R T .\]</p><p>Above, <span>$R ‚â° ‚Ñõ / m$</span> is the specific gas constant given the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a> <span>$‚Ñõ ‚âà 8.31 \; \mathrm{J} \, \mathrm{K}^{-1} \, \mathrm{mol}^{-1}$</span> and molar mass <span>$m$</span> of the gas species under consideration.</p><p>The <a href="https://en.wikipedia.org/wiki/First_law_of_thermodynamics">first law of thermodynamics</a>, aka &quot;conservation of energy&quot;, states that infinitesimal changes in &quot;heat content&quot;<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup> <span>$\mathrm{d} \mathcal{H}$</span> are related to infinitesimal changes in temperature <span>$\mathrm{d} T$</span> and pressure <span>$\mathrm{d} p$</span> according to:<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2" class="footnote-ref">[2]</a><span class="footnote-preview" id="fn-2"></span></sup></p><p class="math-container">\[\mathrm{d} \mathcal{H} = c·µñ \mathrm{d} T - \frac{\mathrm{d} p}{œÅ} ,\]</p><p>where <span>$c·µñ$</span> is the specific heat capacity at constant pressure of the gas in question.</p><p>For example, to represent dry air typical for Earth, with molar mass <span>$m = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and constant-pressure heat capacity <span>$c^p = 1005 \; \mathrm{J} \, \mathrm{kg}^{-1} \, \mathrm{K}^{-1}$</span>, we write</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: IdealGas
dry_air = IdealGas(molar_mass=0.029, heat_capacity=1005)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IdealGas{Float64}(molar_mass=0.029, heat_capacity=1005.0)</code></pre><p>We can also change the properties of dry air by specifying new values when constructing <code>ThermodynamicConstants</code>,</p><pre><code class="language-julia hljs">weird_thermo = ThermodynamicConstants(dry_air_molar_mass=0.042, dry_air_heat_capacity=420)
weird_thermo.dry_air</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IdealGas{Float64}(molar_mass=0.042, heat_capacity=420.0)</code></pre><h3 id="Potential-temperature-and-&quot;adiabatic&quot;-transformations"><a class="docs-heading-anchor" href="#Potential-temperature-and-&quot;adiabatic&quot;-transformations">Potential temperature and &quot;adiabatic&quot; transformations</a><a id="Potential-temperature-and-&quot;adiabatic&quot;-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-temperature-and-&quot;adiabatic&quot;-transformations" title="Permalink"></a></h3><p>Within adiabatic transformations, <span>$\mathrm{d} \mathcal{H} = 0$</span>. Then, combining the ideal gas law with conservation of energy yields</p><p class="math-container">\[\frac{\mathrm{d} T}{T} = \frac{R}{c·µñ} \frac{\mathrm{d} p}{p} ,\]</p><p>which implies that <span>$T ‚àº ( p / p‚ÇÄ )^{R / c·µñ}$</span>, where <span>$p‚ÇÄ$</span> is some reference pressure value.</p><p>As a result, the <em>potential temperature</em>, <span>$Œ∏$</span>, defined as</p><p class="math-container">\[Œ∏ ‚â° T \big / \left ( \frac{p}{p‚ÇÄ} \right )^{R / c·µñ} = \frac{T}{Œ†} ,\]</p><p>remains constant under adiabatic transformations. Notice that above, we also defined the Exner function, <span>$Œ† ‚â° ( p / p‚ÇÄ )^{R / c·µñ}$</span>.</p><div class="admonition is-info" id="About-subscripts-d75a6bd6b0f8e38"><header class="admonition-header">About subscripts<a class="admonition-anchor" href="#About-subscripts-d75a6bd6b0f8e38" title="Permalink"></a></header><div class="admonition-body"><p>The subscript &quot;0&quot; typically indicates some quantity evaluated at the surface <span>$z=0$</span>. By convention, we tend to invoke constants that represent profiles evaluated at <span>$z=0$</span>: i.e., <span>$p‚ÇÄ = p(z=0)$</span>, <span>$T‚ÇÄ = T(z=0)$</span>, etc. This implies that the potential temperature under adiabatic transformation is <span>$Œ∏(z) = Œ∏‚ÇÄ = T‚ÇÄ$</span>.</p></div></div><h3 id="Hydrostatic-balance"><a class="docs-heading-anchor" href="#Hydrostatic-balance">Hydrostatic balance</a><a id="Hydrostatic-balance-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrostatic-balance" title="Permalink"></a></h3><p>Next we consider a reference state that does not exchange energy with its environment (i.e., <span>$\mathrm{d} \mathcal{H} = 0$</span>) and thus has constant potential temperature</p><p class="math-container">\[Œ∏‚ÇÄ = T·µ£ \left ( \frac{p‚ÇÄ}{p·µ£} \right )^{R / c·µñ} .\]</p><div class="admonition is-info" id="Reference-states-1fc012195c65e05f"><header class="admonition-header">Reference states<a class="admonition-anchor" href="#Reference-states-1fc012195c65e05f" title="Permalink"></a></header><div class="admonition-body"><p>Subscripts <span>$r$</span> indicate a <em>reference</em> state. The adiabatic, hydrostatically-balanced reference state in the process of elucidation presently has a <span>$z$</span> dependent reference pressure <span>$p·µ£(z)$</span>, density <span>$œÅ·µ£(z)$</span>, and temperature <span>$T·µ£(z)$</span>. This reference state also has a <em>constant</em> potential temperature <span>$Œ∏‚ÇÄ$</span>, which we attempt to clarify by writing <span>$Œ∏‚ÇÄ$</span> (since it&#39;s constant, it has the same value at <span>$z=0$</span> as at any height). We apologize that our notation differs from the usual in which <span>$0$</span> subscripts indicate &quot;reference&quot; (ü§î) and <span>$00$</span> (ü´£) means <span>$z=0$</span>.</p></div></div><p>Hydrostatic balance requires</p><p class="math-container">\[‚àÇ_z p·µ£ = - œÅ·µ£ g ,\]</p><p>where <span>$g$</span> is gravitational acceleration, naturally by default</p><pre><code class="language-julia hljs">thermo.gravitational_acceleration</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9.81</code></pre><p>By combining the hydrostatic balance with the ideal gas law and the definition of potential temperature we get</p><p class="math-container">\[\frac{p·µ£}{p‚ÇÄ} = \left (1 - \frac{g z}{c·µñ Œ∏‚ÇÄ} \right )^{c·µñ / R} .\]</p><p>Thus</p><p class="math-container">\[\begin{align*}
T·µ£(z) &amp; = Œ∏‚ÇÄ \left ( \frac{p·µ£}{p‚ÇÄ} \right )^{R / c·µñ} \\
      &amp; = Œ∏‚ÇÄ - \frac{g}{c·µñ} z,
\end{align*}\]</p><p>and</p><p class="math-container">\[œÅ·µ£(z) = \frac{p‚ÇÄ}{R·µà Œ∏‚ÇÄ} \left ( 1 - \frac{g z}{c·µñ Œ∏‚ÇÄ} \right )^{c·µñ / R - 1} .\]</p><p>The quantity <span>$g / c·µñ ‚âà 9.76 \;\mathrm{K}\,\mathrm{km}^{-1}$</span> that appears above is also referred to as the &quot;<a href="https://en.wikipedia.org/wiki/Lapse_rate">dry adiabatic lapse rate</a>&quot;.</p><h3 id="An-example-of-a-dry-reference-state-in-Breeze"><a class="docs-heading-anchor" href="#An-example-of-a-dry-reference-state-in-Breeze">An example of a dry reference state in Breeze</a><a id="An-example-of-a-dry-reference-state-in-Breeze-1"></a><a class="docs-heading-anchor-permalink" href="#An-example-of-a-dry-reference-state-in-Breeze" title="Permalink"></a></h3><p>We can visualise a hydrostatic reference profile evaluating Breeze&#39;s reference-state utilities (which assume a dry reference state) on a one-dimensional <code>RectilinearGrid</code>. In the following code, the superscript <span>$d$</span> denotes dry air, e.g., an ideal gas with <span>$R·µà = 286.71 \; \mathrm{J} \, \mathrm{K}^{-1}$</span>:</p><pre><code class="language-julia hljs">using Breeze
using CairoMakie

grid = RectilinearGrid(size=160, z=(0, 12_000), topology=(Flat, Flat, Bounded))
thermo = ThermodynamicConstants()
reference_state = ReferenceState(grid, thermo, base_pressure=101325, potential_temperature=288)

p·µ£ = reference_state.pressure
œÅ·µ£ = reference_state.density

R·µà = Breeze.Thermodynamics.dry_air_gas_constant(thermo)
c·µñ·µà = thermo.dry_air.heat_capacity
p‚ÇÄ = reference_state.base_pressure
Œ∏‚ÇÄ = reference_state.potential_temperature
g = thermo.gravitational_acceleration

# Verify that T·µ£ = Œ∏‚ÇÄ - (g / c·µñ·µà) * z
z = KernelFunctionOperation{Center, Center, Center}(znode, grid, Center(), Center(), Center())
T·µ£‚ÇÅ = Field(Œ∏‚ÇÄ * (p·µ£ / p‚ÇÄ)^(R·µà / c·µñ·µà))
T·µ£‚ÇÇ = Field(Œ∏‚ÇÄ - (g / c·µñ·µà) * z)

fig = Figure()

axT = Axis(fig[1, 1]; xlabel = &quot;Temperature (·µíK)&quot;, ylabel = &quot;Height (m)&quot;)
lines!(axT, T·µ£‚ÇÅ)
lines!(axT, T·µ£‚ÇÇ, linestyle = :dash, color = :orange, linewidth = 2)

axp = Axis(fig[1, 2]; xlabel = &quot;Pressure (10‚Åµ Pa)&quot;, yticklabelsvisible = false)
lines!(axp, p·µ£ / 1e5)

axœÅ = Axis(fig[1, 3]; xlabel = &quot;Density (kg m‚Åª¬≥)&quot;, yticklabelsvisible = false)
lines!(axœÅ, œÅ·µ£)

fig</code></pre><img src="e0a4c131.svg" alt="Example block output"/><h2 id="The-gaseous-nature-of-moist-air"><a class="docs-heading-anchor" href="#The-gaseous-nature-of-moist-air">The gaseous nature of moist air</a><a id="The-gaseous-nature-of-moist-air-1"></a><a class="docs-heading-anchor-permalink" href="#The-gaseous-nature-of-moist-air" title="Permalink"></a></h2><p>To define the gaseous nature of moist air - that is, the equation of state relating density and pressure, we assume that the <em>volume</em> of liquid and ice components are negligible. As a result, moist air pressure is the sum of partial pressures of vapor and dry air with no contribution from liquid or ice phases,</p><p class="math-container">\[p = p·µà + p·µõ .\]</p><p>Because the dry air and vapor components are ideal gases, their densities are related to pressure through the ideal gas law,</p><p class="math-container">\[p·µà = œÅ·µà R·µà T \qquad \text{and} \qquad p·µõ = œÅ·µõ R·µõ T ,\]</p><p>where <span>$T$</span> is temperature, <span>$R‚Å± = ‚Ñõ / m^Œ≤$</span> is the specific gas constant for component <span>$Œ≤$</span>, <span>$m^Œ≤$</span> is the molar mass of component <span>$Œ≤$</span>, and <span>$‚Ñõ$</span>  is the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a>,</p><pre><code class="language-julia hljs">thermo = ThermodynamicConstants()
thermo.molar_gas_constant</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.314462618</code></pre><p><a href="../api/#Breeze.Thermodynamics.ThermodynamicConstants"><code>ThermodynamicConstants</code></a>, which is central to Breeze&#39;s implementation of moist thermodynamics. holds constants like the molar gas constant and molar masses, latent heats, gravitational acceleration, and more,</p><pre><code class="language-julia hljs">thermo</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ThermodynamicConstants{Float64}:
‚îú‚îÄ‚îÄ molar_gas_constant: 8.314462618
‚îú‚îÄ‚îÄ gravitational_acceleration: 9.81
‚îú‚îÄ‚îÄ energy_reference_temperature: 273.15
‚îú‚îÄ‚îÄ triple_point_temperature: 273.16
‚îú‚îÄ‚îÄ triple_point_pressure: 611.657
‚îú‚îÄ‚îÄ dry_air: IdealGas{Float64}(molar_mass=0.02897, heat_capacity=1005.0)
‚îú‚îÄ‚îÄ vapor: IdealGas{Float64}(molar_mass=0.018015, heat_capacity=1850.0)
‚îú‚îÄ‚îÄ liquid: CondensedPhase{Float64}(reference_latent_heat=2.5008e6, heat_capacity=4181.0)
‚îî‚îÄ‚îÄ ice: CondensedPhase{Float64}(reference_latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>These default values evince basic facts about water vapor air typical to Earth&#39;s atmosphere: for example, the molar masses of dry air (itself a mixture of mostly nitrogen, oxygen, and argon), and water vapor are <span>$m·µà = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and <span>$m·µõ = 0.018 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span>. And even more interesting, the triple point temperature and pressure of water vapor are</p><pre><code class="language-julia hljs">thermo.triple_point_temperature, thermo.triple_point_pressure</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(273.16, 611.657)</code></pre><p>not so far from the typical conditions we experience on Earth&#39;s surface - one of the reasons that things are so interesting down here. Also, that temperature is not a typo: the triple point temperature really is just <span>$+0.01^\circ$</span>C.</p><p>It&#39;s then convenient to introduce the &quot;mixture&quot; gas constant <span>$R·µê(q·µõ)$</span> such that</p><p class="math-container">\[p = œÅ R·µê T, \qquad \text{where} \qquad R·µê ‚â° q·µà R·µà + q·µõ R·µõ .\]</p><p>To illustrate, let&#39;s compute the mixture gas constant <span>$R·µê$</span> for air with a small amount of water vapor. The contribution of vapor increases <span>$R·µê$</span> above the dry air value:</p><pre><code class="language-julia hljs">q = Breeze.Thermodynamics.MoistureMassFractions(0.01, 0.0, 0.0) # 1% vapor by mass
R·µà = Breeze.Thermodynamics.dry_air_gas_constant(thermo)
R·µê = Breeze.Thermodynamics.mixture_gas_constant(q, thermo)
R·µê - R·µà # shows the uplift from the vapor component</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7452747490884803</code></pre><p>A small increase in specific humidity increases the effective gas constant of air.</p><h2 id="The-thermal-properties-of-moist-air"><a class="docs-heading-anchor" href="#The-thermal-properties-of-moist-air">The thermal properties of moist air</a><a id="The-thermal-properties-of-moist-air-1"></a><a class="docs-heading-anchor-permalink" href="#The-thermal-properties-of-moist-air" title="Permalink"></a></h2><p>Though we neglect the volume of liquid and ice, we do not neglect their <em>mass</em> or <em>energy</em>. The heat capacity of moist air thus includes contributions from all four components,</p><p class="math-container">\[c·µñ·µê = q·µà c·µñ·µà + q·µõ c·µñ·µõ + qÀ° cÀ° + q‚Å± c‚Å±,\]</p><p>where the <span>$c·µñ·µù$</span> denote the specific heat capacity at constant pressure of constituent <span>$Œ≤$</span>, and we have neglected the superscript <span>$p$</span> for liquid and ice because they are assumed incompressible (their specific heats and constant pressure or volume are the same). We call <span>$c·µñ·µê$</span> the &quot;mixture heat capacity&quot;, and because with default parameters the heat capacity of dry air is the smallest of either vapor, liquid, or ice, any moisture at all tends to increase the mixture heat capacity,</p><pre><code class="language-julia hljs">q = Breeze.Thermodynamics.MoistureMassFractions(0.01, 0.0, 0.0)
c·µñ·µà = thermo.dry_air.heat_capacity
c·µñ·µê = Breeze.Thermodynamics.mixture_heat_capacity(q, thermo)
c·µñ·µê - c·µñ·µà</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.450000000000045</code></pre><h2 id="The-Clausius‚ÄìClapeyron-relation-and-saturation-vapor-pressure"><a class="docs-heading-anchor" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-vapor-pressure">The Clausius‚ÄìClapeyron relation and saturation vapor pressure</a><a id="The-Clausius‚ÄìClapeyron-relation-and-saturation-vapor-pressure-1"></a><a class="docs-heading-anchor-permalink" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-vapor-pressure" title="Permalink"></a></h2><p>The <a href="https://en.wikipedia.org/wiki/Clausius%E2%80%93Clapeyron_relation">Clausius‚ÄìClapeyron relation</a> for an ideal gas describes how saturation vapor pressure changes with temperature:</p><p class="math-container">\[\frac{\mathrm{d} p·µõ‚Å∫}{\mathrm{d} T} = \frac{p·µõ‚Å∫ ‚Ñí^Œ≤(T)}{R·µõ T^2} ,\]</p><p>where <span>$p·µõ‚Å∫$</span> is saturation vapor pressure over a surface of condensed phase <span>$Œ≤$</span>, <span>$T$</span> is temperature, <span>$R·µõ$</span> is the specific gas constant for vapor, and <span>$‚Ñí^Œ≤(T)$</span> is the latent heat of the phase transition from vapor to phase <span>$Œ≤$</span>. For atmospheric moist air, the relevant condensed phases are liquid water (<span>$Œ≤ = l$</span>) and ice (<span>$Œ≤ = i$</span>).</p><h3 id="Temperature-dependent-latent-heat"><a class="docs-heading-anchor" href="#Temperature-dependent-latent-heat">Temperature-dependent latent heat</a><a id="Temperature-dependent-latent-heat-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-dependent-latent-heat" title="Permalink"></a></h3><p>For a thermodynamic formulation that uses constant (i.e. temperature-independent) specific heats, the latent heat of a phase transition is linear in temperature:</p><p class="math-container">\[‚Ñí^Œ≤(T) = ‚Ñí^Œ≤_0 + \Delta c^Œ≤ \, T ,\]</p><p>where <span>$‚Ñí^Œ≤_0 ‚â° ‚Ñí^Œ≤(T=0)$</span> is the latent heat at absolute zero and <span>$\Delta c^Œ≤ ‚â° c_p^v - c^Œ≤$</span> is the constant difference between the vapor specific heat capacity at constant pressure and the specific heat capacity of the condensed phase <span>$Œ≤$</span>.</p><p>Note that we typically parameterize the latent heat in terms of a reference temperature <span>$T_r$</span> that is well above absolute zero. In that case, the latent heat is written</p><p class="math-container">\[‚Ñí^Œ≤(T) = ‚Ñí^Œ≤_r + \Delta c^Œ≤ (T - T_r), \qquad \text{and} \qquad
‚Ñí^Œ≤_0 = ‚Ñí^Œ≤_r - \Delta c^Œ≤ T_r ,\]</p><p>where <span>$‚Ñí^Œ≤_r$</span> is the latent heat at the reference temperature <span>$T_r$</span>.</p><h3 id="Integration-of-the-Clausius-Clapeyron-relation"><a class="docs-heading-anchor" href="#Integration-of-the-Clausius-Clapeyron-relation">Integration of the Clausius-Clapeyron relation</a><a id="Integration-of-the-Clausius-Clapeyron-relation-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-of-the-Clausius-Clapeyron-relation" title="Permalink"></a></h3><p>To find the saturation vapor pressure as a function of temperature, we integrate the Clausius-Clapeyron relation with the temperature-linear latent heat model from the triple point pressure and temperature <span>$(p^{tr}, T^{tr})$</span> to a generic pressure <span>$p·µõ‚Å∫$</span> and temperature <span>$T$</span>:</p><p class="math-container">\[\int_{p^{tr}}^{p·µõ‚Å∫} \frac{\mathrm{d} p}{p} = \int_{T^{tr}}^{T} \frac{‚Ñí^Œ≤_0 + \Delta c^Œ≤ T&#39;}{R·µõ T&#39;^2} \, \mathrm{d} T&#39; .\]</p><p>Evaluating the integrals yields</p><p class="math-container">\[\log\left(\frac{p·µõ‚Å∫}{p^{tr}}\right) = -\frac{‚Ñí^Œ≤_0}{R·µõ T} + \frac{‚Ñí^Œ≤_0}{R·µõ T^{tr}} + \frac{\Delta c^Œ≤}{R·µõ} \log\left(\frac{T}{T^{tr}}\right) .\]</p><p>Exponentiating both sides gives the closed-form solution:</p><p class="math-container">\[p·µõ‚Å∫(T) = p^{tr} \left ( \frac{T}{T^{tr}} \right )^{\Delta c^Œ≤ / R·µõ} \exp \left [ \frac{‚Ñí^Œ≤_0}{R·µõ} \left (\frac{1}{T^{tr}} - \frac{1}{T} \right ) \right ] .\]</p><h3 id="Example:-liquid-water-and-ice-parameters"><a class="docs-heading-anchor" href="#Example:-liquid-water-and-ice-parameters">Example: liquid water and ice parameters</a><a id="Example:-liquid-water-and-ice-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-liquid-water-and-ice-parameters" title="Permalink"></a></h3><p>Consider parameters for liquid water,</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: CondensedPhase
liquid_water = CondensedPhase(reference_latent_heat=2500800, heat_capacity=4181)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(reference_latent_heat=2.5008e6, heat_capacity=4181.0)</code></pre><p>and water ice,</p><pre><code class="language-julia hljs">water_ice = CondensedPhase(reference_latent_heat=2834000, heat_capacity=2108)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(reference_latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>These represent the latent heat of vaporization at the reference temperature and the specific heat capacity of each condensed phase. We can compute the specific heat difference <span>$\Delta c^Œ≤$</span> for liquid water:</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: vapor_gas_constant
c·µñ·µõ = thermo.vapor.heat_capacity
cÀ° = thermo.liquid.heat_capacity
ŒîcÀ° = c·µñ·µõ - cÀ°</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-2331.0</code></pre><p>This difference <span>$\Delta c^l$</span> above is negative because water vapor has a lower heat capacity than liquid water.</p><h3 id="Mixed-phase-saturation-vapor-pressure"><a class="docs-heading-anchor" href="#Mixed-phase-saturation-vapor-pressure">Mixed-phase saturation vapor pressure</a><a id="Mixed-phase-saturation-vapor-pressure-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-phase-saturation-vapor-pressure" title="Permalink"></a></h3><p>In atmospheric conditions near the freezing point, condensate may exist as a mixture of liquid and ice. Following <a href="../references/#Pressel2015">Pressel <em>et al.</em> (2015)</a>, we model the saturation vapor pressure over a mixed-phase surface using a liquid fraction <span>$Œª$</span> that varies smoothly between 0 (pure ice) and 1 (pure liquid). The effective latent heat and specific heat difference for the mixture are computed as weighted averages:</p><p class="math-container">\[‚Ñí^{li}_0 = Œª \, ‚Ñí^l_0 + (1 - Œª) \, ‚Ñí^i_0 ,\]</p><p class="math-container">\[\Delta c^{li} = Œª \, \Delta c^l + (1 - Œª) \, \Delta c^i .\]</p><p>These effective properties are then used in the Clausius-Clapeyron formula to compute the saturation vapor pressure over the mixed-phase surface. This approach ensures thermodynamic consistency and smooth transitions between pure liquid and pure ice states.</p><p>We can illustrate this by computing the mixed-phase specific heat difference for a 50/50 mixture:</p><pre><code class="language-julia hljs">Œîc‚Å± = thermo.vapor.heat_capacity - thermo.ice.heat_capacity
Œª = 0.5
ŒîcÀ°‚Å± = Œª * ŒîcÀ° + (1 - Œª) * Œîc‚Å±</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-1294.5</code></pre><h3 id="Visualizing-saturation-vapor-pressure"><a class="docs-heading-anchor" href="#Visualizing-saturation-vapor-pressure">Visualizing saturation vapor pressure</a><a id="Visualizing-saturation-vapor-pressure-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-saturation-vapor-pressure" title="Permalink"></a></h3><p>The saturation vapor pressure over liquid, ice, and mixed-phase surfaces can be computed and visualized:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: saturation_vapor_pressure, PlanarMixedPhaseSurface

thermo = ThermodynamicConstants()

T = collect(200:0.1:320)
p·µõÀ°‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, thermo.liquid) for T‚Å± in T]
p·µõ‚Å±‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, thermo.ice) for T‚Å± in T]
p·µõ‚Å±‚Å∫[T .&gt; thermo.triple_point_temperature] .= NaN

# Mixed-phase surface with 50% liquid, 50% ice
mixed_surface = PlanarMixedPhaseSurface(0.5)
p·µõ·µê‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, mixed_surface) for T‚Å± in T]

using CairoMakie

fig = Figure()
ax = Axis(fig[1, 1], xlabel=&quot;Temperature (·µíK)&quot;, ylabel=&quot;Saturation vapor pressure p·µõ‚Å∫ (Pa)&quot;,
          yscale = log10, xticks=200:20:320)
lines!(ax, T, p·µõÀ°‚Å∫, label=&quot;liquid&quot;, linewidth=2)
lines!(ax, T, p·µõ‚Å±‚Å∫, label=&quot;ice&quot;, linestyle=:dash, linewidth=2)
lines!(ax, T, p·µõ·µê‚Å∫, label=&quot;mixed (Œª=0.5)&quot;, linestyle=:dot, linewidth=2, color=:purple)
axislegend(ax, position=:rb)
fig</code></pre><img src="0f50e2d5.svg" alt="Example block output"/><p>The mixed-phase saturation vapor pressure lies between the liquid and ice curves, providing a smooth interpolation between the two pure phases.</p><h2 id="Saturation-specific-humidity"><a class="docs-heading-anchor" href="#Saturation-specific-humidity">Saturation specific humidity</a><a id="Saturation-specific-humidity-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-specific-humidity" title="Permalink"></a></h2><p>The saturation specific humidity <span>$q·µõ‚Å∫$</span> is the maximum amount of water vapor that can exist in equilibrium with a condensed phase at a given temperature and density. It is related to the saturation vapor pressure by:</p><p class="math-container">\[q·µõ‚Å∫ ‚â° \frac{œÅ·µõ‚Å∫}{œÅ} = \frac{p·µõ‚Å∫}{œÅ R·µõ T} ,\]</p><p>where <span>$œÅ·µõ‚Å∫$</span> is the vapor density at saturation, <span>$œÅ$</span> is the total air density, and <span>$R·µõ$</span> is the specific gas constant for water vapor.</p><h3 id="Visualizing-saturation-vapor-pressure-and-specific-humidity"><a class="docs-heading-anchor" href="#Visualizing-saturation-vapor-pressure-and-specific-humidity">Visualizing saturation vapor pressure and specific humidity</a><a id="Visualizing-saturation-vapor-pressure-and-specific-humidity-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-saturation-vapor-pressure-and-specific-humidity" title="Permalink"></a></h3><p>We can visualize how both saturation vapor pressure and saturation specific humidity vary with temperature for different liquid fractions, demonstrating the smooth interpolation provided by the mixed-phase model:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: saturation_vapor_pressure, saturation_specific_humidity, PlanarMixedPhaseSurface

thermo = ThermodynamicConstants()

# Temperature range covering typical atmospheric conditions
T = collect(250:0.1:320)
p‚ÇÄ = 101325  # Surface pressure (Pa)
R·µà = Breeze.Thermodynamics.dry_air_gas_constant(thermo)

# Liquid fractions to visualize
Œª_values = [0.0, 0.25, 0.5, 0.75, 1.0]
labels = [&quot;ice (Œª=0)&quot;, &quot;Œª=0.25&quot;, &quot;Œª=0.5&quot;, &quot;Œª=0.75&quot;, &quot;liquid (Œª=1)&quot;]
colors = [:blue, :cyan, :purple, :orange, :red]
linestyles = [:solid, :dash, :dot, :dashdot, :solid]

using CairoMakie

fig = Figure(size=(1000, 400))

# Panel 1: Saturation vapor pressure
ax1 = Axis(fig[1, 1], xlabel=&quot;Temperature (K)&quot;, ylabel=&quot;Saturation vapor pressure (Pa)&quot;,
           yscale=log10, title=&quot;Saturation vapor pressure&quot;)

for (i, Œª) in enumerate(Œª_values)
    surface = PlanarMixedPhaseSurface(Œª)
    p·µõ‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, surface) for T‚Å± in T]
    lines!(ax1, T, p·µõ‚Å∫, label=labels[i], color=colors[i], linestyle=linestyles[i], linewidth=2)
end

axislegend(ax1, position=:lt)

# Panel 2: Saturation specific humidity
ax2 = Axis(fig[1, 2], xlabel=&quot;Temperature (K)&quot;, ylabel=&quot;Saturation specific humidity (kg/kg)&quot;,
           title=&quot;Saturation specific humidity&quot;)

for (i, Œª) in enumerate(Œª_values)
    surface = PlanarMixedPhaseSurface(Œª)
    q·µõ‚Å∫ = zeros(length(T))
    for (j, T‚Å±) in enumerate(T)
        œÅ = p‚ÇÄ / (R·µà * T‚Å±)  # Approximate density using dry air
        q·µõ‚Å∫[j] = saturation_specific_humidity(T‚Å±, œÅ, thermo, surface)
    end
    lines!(ax2, T, q·µõ‚Å∫, label=labels[i], color=colors[i], linestyle=linestyles[i], linewidth=2)
end

fig</code></pre><img src="44290eec.svg" alt="Example block output"/><p>This figure shows how the liquid fraction <span>$Œª$</span> smoothly interpolates between pure ice (<span>$Œª = 0$</span>) and pure liquid (<span>$Œª = 1$</span>). At lower temperatures, the differences between phases are more pronounced. The mixed-phase model allows for realistic representation of conditions near the freezing point where both liquid and ice may coexist.</p><h2 id="Moist-static-energy"><a class="docs-heading-anchor" href="#Moist-static-energy">Moist static energy</a><a id="Moist-static-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Moist-static-energy" title="Permalink"></a></h2><p>For moist air, a convenient thermodynamic invariant that couples temperature, composition, and height is the moist static energy (MSE),</p><p class="math-container">\[e ‚â° c·µñ·µê \, T + g z - LÀ°·µ£ \, qÀ° - L‚Å±·µ£ q‚Å± .\]</p><div class="admonition is-info" id="The-alternative-&#39;frozen-moist-static-energy&#39;-variable-79d4d728d265d82b"><header class="admonition-header">The alternative &#39;frozen moist static energy&#39; variable<a class="admonition-anchor" href="#The-alternative-&#39;frozen-moist-static-energy&#39;-variable-79d4d728d265d82b" title="Permalink"></a></header><div class="admonition-body"><p>An alternative, physically equivalent, definition of moist static energy used in atmospheric models such as the Global System for Atmospheric Modeling (GSAM) (<a href="../references/#Khairoutdinov2022">Khairoutdinov <em>et al.</em>, 2022</a>) is</p><p class="math-container">\[eÃÉ ‚â° c·µñ·µê \, T + g z + LÀ°·µ£ \, q·µõ - L·∂†·µ£ q‚Å± .\]</p><p><span>$e$</span> and <span>$eÃÉ$</span> are not the same, but they obey the same conservation equation provided that total moisture fraction is conserved, or that <span>$\mathrm{D}q·µó / \mathrm{D}t = 0$</span>.</p></div></div><h2 id="Liquid-ice-potential-temperature"><a class="docs-heading-anchor" href="#Liquid-ice-potential-temperature">Liquid-ice potential temperature</a><a id="Liquid-ice-potential-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Liquid-ice-potential-temperature" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><span>$\mathcal{H}$</span> is called <a href="https://en.wikipedia.org/wiki/Enthalpy"><em>enthalpy</em></a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><p>The conservation of energy states that any external heat input into the gas must equal the sum   of the change of the gas&#39;s internal energy and the work done by the gas, <span>$p \, \mathrm{d} V$</span>.   For atmospheric flows it&#39;s convenient to express everything per unit mass. Assuming the mass of   the fluid is conserved, we have that the work done per unit mass is <span>$p \, \mathrm{d}(\rho^{-1})$</span>   and the internal energy per unit mass is <span>$\mathcal{I} ‚â° c·µõ \mathrm{d} T$</span>.   Therefore, if <span>$\mathrm{d} \mathcal{H}$</span> is the change in heat content per unit mass,   we have:</p><p class="math-container">\[\mathrm{d} \mathcal{H} = c·µõ \mathrm{d} T + p \, \mathrm{d}(œÅ^{-1}) .\]</p><p>By utilizing the identity <span>$\mathrm{d}(p / œÅ) = p \, \mathrm{d}(œÅ^{-1}) + œÅ^{-1} \mathrm{d}p$</span> and using the ideal gas, we can rewrite the above conservation law as:</p><p class="math-container">\[\mathrm{d} \mathcal{H} = (c·µõ + R) \mathrm{d} T - œÅ^{-1} \mathrm{d}p ,\]</p><p>which is the expression in the main text after noting that the specific heat capacities under constant pressure and under constant volume are related via <span>$c·µñ ‚â° c·µõ + R$</span>.</p></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../literated/cloudy_kelvin_helmholtz/">¬´ Cloudy Kelvin-Helmholtz instability</a><a class="docs-footer-nextpage" href="../microphysics/microphysics_overview/">Overview ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 25 November 2025 20:44">Tuesday 25 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
