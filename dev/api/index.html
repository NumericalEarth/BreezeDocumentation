<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API ¬∑ Breeze</title><meta name="title" content="API ¬∑ Breeze"/><meta property="og:title" content="API ¬∑ Breeze"/><meta property="twitter:title" content="API ¬∑ Breeze"/><meta name="description" content="Documentation for Breeze."/><meta property="og:description" content="Documentation for Breeze."/><meta property="twitter:description" content="Documentation for Breeze."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Breeze</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../literated/thermal_bubble/">Thermal bubble</a></li><li><a class="tocitem" href="../literated/cloudy_kelvin_helmholtz/">Cloudy Kelvin-Helmholtz instability</a></li></ul></li><li><a class="tocitem" href="../thermodynamics/">Thermodynamics</a></li><li><span class="tocitem">Microphysics</span><ul><li><a class="tocitem" href="../microphysics/microphysics_overview/">Overview</a></li><li><a class="tocitem" href="../microphysics/warm_phase_saturation_adjustment/">Warm-phase saturation adjustment</a></li><li><a class="tocitem" href="../microphysics/mixed_phase_saturation_adjustment/">Mixed-phase saturation adjustment</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Microphysics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../developer/microphysics_interface/">Microphysics Interface</a></li></ul></li></ul></li><li><a class="tocitem" href="../dycore_equations_algorithms/">Dycore equations and algorithms</a></li><li><span class="tocitem">Appendix</span><ul><li><a class="tocitem" href="../appendix/notation/">Notation</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Private-API"><span>Private API</span></a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributors guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="Breeze.Breeze"><a class="docstring-binding" href="#Breeze.Breeze"><code>Breeze.Breeze</code></a> ‚Äî <span class="docstring-category">Module</span></summary><section><div><p>Julia package for finite volume GPU and CPU large eddy simulations (LES) of atmospheric flows. The abstractions, design, and finite volume engine are based on Oceananigans.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Breeze.jl#L1-L5">source</a></section></details></article><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><h3 id="Thermodynamics"><a class="docs-heading-anchor" href="#Thermodynamics">Thermodynamics</a><a id="Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.CondensedPhase"><a class="docstring-binding" href="#Breeze.Thermodynamics.CondensedPhase"><code>Breeze.Thermodynamics.CondensedPhase</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CondensedPhase(; ...)
CondensedPhase(FT; reference_latent_heat, heat_capacity)
</code></pre><p>Returns <code>CondensedPhase</code> with specified parameters converted to <code>FT</code>.</p><p>Two examples of <code>CondensedPhase</code> are liquid and ice. When matter is converted from vapor to liquid, water molecules in the gas phase cluster together and slow down to form liquid with <code>heat_capacity</code>, The lost of molecular kinetic energy is called the <code>reference_latent_heat</code>.</p><p>Likewise, during deposition, water molecules in the gas phase cluster into ice crystals.</p><p><strong>Arguments</strong></p><ul><li><code>FT</code>: Float type to use (defaults to <code>Oceananigans.defaults.FloatType</code>)</li><li><code>reference_latent_heat</code>: Difference between the internal energy of the gaseous phase at the <code>energy_reference_temperature</code>.</li><li><code>heat_capacity</code>: Heat capacity of the phase of matter.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.IdealGas"><a class="docstring-binding" href="#Breeze.Thermodynamics.IdealGas"><code>Breeze.Thermodynamics.IdealGas</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct IdealGas{FT}</code></pre><p>A struct representing an ideal gas with molar mass and specific heat capacity.</p><p><strong>Fields</strong></p><ul><li><code>molar_mass</code>: Molar mass of the gas in kg/mol</li><li><code>heat_capacity</code>: Specific heat capacity at constant pressure in J/(kg¬∑K)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">dry_air = IdealGas(molar_mass=0.02897, heat_capacity=1005)

# output
IdealGas{Float64}(molar_mass=0.02897, heat_capacity=1005.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L4">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.ReferenceState"><a class="docstring-binding" href="#Breeze.Thermodynamics.ReferenceState"><code>Breeze.Thermodynamics.ReferenceState</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ReferenceState(
    grid;
    ...
) -&gt; ReferenceState{_A, F} where {_A, F&lt;:(Field{Nothing, Nothing, Center, Nothing, G, I, D, T, B, Nothing} where {G, I, D, T, B})}
ReferenceState(
    grid,
    thermo;
    base_pressure,
    potential_temperature
) -&gt; ReferenceState{_A, F} where {_A, F&lt;:(Field{Nothing, Nothing, Center, Nothing, G, I, D, T, B, Nothing} where {G, I, D, T, B})}
</code></pre><p>Return a <code>ReferenceState</code> on <code>grid</code>, with <a href="#Breeze.Thermodynamics.ThermodynamicConstants"><code>ThermodynamicConstants</code></a> <code>thermo</code> that includes the adiabatic hydrostatic reference pressure and reference density for a <code>base_pressure</code> and <code>potential_temperature</code>.</p><p><strong>Arguments</strong></p><ul><li><code>grid</code>: The grid.</li><li><code>thermo :: ThermodynamicConstants</code>: By default, <code>ThermodynamicConstants(eltype(grid))</code>.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>base_pressure</code>: By default, 101325.</li><li><code>potential_temperature</code>: By default, 288.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/reference_states.jl#L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.ThermodynamicConstants"><a class="docstring-binding" href="#Breeze.Thermodynamics.ThermodynamicConstants"><code>Breeze.Thermodynamics.ThermodynamicConstants</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ThermodynamicConstants(; ...) -&gt; ThermodynamicConstants
ThermodynamicConstants(
    FT;
    molar_gas_constant,
    gravitational_acceleration,
    energy_reference_temperature,
    triple_point_temperature,
    triple_point_pressure,
    dry_air_molar_mass,
    dry_air_heat_capacity,
    vapor_molar_mass,
    vapor_heat_capacity,
    liquid,
    ice
) -&gt; ThermodynamicConstants
</code></pre><p>Return <code>ThermodynamicConstants</code> with parameters that represent gaseous mixture of dry &quot;air&quot; and vapor, as well as condensed liquid and ice phases. The <code>triple_point_temperature</code> and <code>triple_point_pressure</code> may be combined with internal energy parameters for condensed phases to compute the vapor pressure at the boundary between vapor and a homogeneous sample of the condensed phase. The <code>gravitational_acceleration</code> parameter is included to compute <a href="#Breeze.Thermodynamics.ReferenceState"><code>ReferenceState</code></a> quantities associated with hydrostatic balance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L147">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.mixture_gas_constant-Tuple{Breeze.Thermodynamics.MoistureMassFractions, ThermodynamicConstants}"><a class="docstring-binding" href="#Breeze.Thermodynamics.mixture_gas_constant-Tuple{Breeze.Thermodynamics.MoistureMassFractions, ThermodynamicConstants}"><code>Breeze.Thermodynamics.mixture_gas_constant</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">mixture_gas_constant(
    q::Breeze.Thermodynamics.MoistureMassFractions,
    thermo::ThermodynamicConstants
) -&gt; Any
</code></pre><p>Return the gas constant of moist air mixture [in J/(kg K)] given the specific humidity <code>q</code> and thermodynamic parameters <code>thermo</code>.</p><p>The mixture gas constant is calculated as a weighted average of the dry air and water vapor gas thermo:</p><p class="math-container">\[R·µê = q·µà R·µà + q·µõ R·µõ ,\]</p><p>where:</p><ul><li><code>R·µà</code> is the dry air gas constant,</li><li><code>R·µõ</code> is the water vapor gas constant,</li><li><code>q·µà</code> is the mass fraction of dry air, and</li><li><code>q·µõ</code> is the mass fraction of water vapor.</li></ul><p><strong>Arguments</strong></p><ul><li><code>q</code>: the moisture mass fractions (vapor, liquid, and ice)</li><li><code>thermo</code>: <code>ThermodynamicConstants</code> instance containing gas thermo</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L234">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.mixture_heat_capacity-Tuple{Breeze.Thermodynamics.MoistureMassFractions, ThermodynamicConstants}"><a class="docstring-binding" href="#Breeze.Thermodynamics.mixture_heat_capacity-Tuple{Breeze.Thermodynamics.MoistureMassFractions, ThermodynamicConstants}"><code>Breeze.Thermodynamics.mixture_heat_capacity</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">mixture_heat_capacity(
    q::Breeze.Thermodynamics.MoistureMassFractions,
    thermo::ThermodynamicConstants
) -&gt; Any
</code></pre><p>Compute the heat capacity of a mixture of dry air, vapor, liquid, and ice, where the mass fractions of vapor, liquid, and ice are given by <code>q</code>. The heat capacity of moist air is the weighted sum of its constituents:</p><p class="math-container">\[c·µñ·µê = q·µà c·µñ·µà + q·µõ c·µñ·µõ + qÀ° cÀ° + q‚Å± c‚Å± ,\]</p><p>where <code>q·µõ = q.vapor</code>, <code>qÀ° = q.liquid</code>, <code>q‚Å± = q.ice</code> are the mass fractions of vapor, liquid, and ice constituents, respectively, and <code>q·µà = 1 - q·µõ - qÀ° - q‚Å±</code> is the mass fraction of dry air. The heat capacities <code>c·µñ·µà</code>, <code>c·µñ·µõ</code>, <code>cÀ°</code>, <code>c‚Å±</code> are the heat capacities of dry air, vapor, liquid, and ice at constant pressure, respectively. The liquid and ice phases are assumed to be incompressible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L265">source</a></section></details></article><h3 id="MoistAirBuoyancies"><a class="docs-heading-anchor" href="#MoistAirBuoyancies">MoistAirBuoyancies</a><a id="MoistAirBuoyancies-1"></a><a class="docs-heading-anchor-permalink" href="#MoistAirBuoyancies" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.MoistAirBuoyancies.MoistAirBuoyancy-Tuple{Any}"><a class="docstring-binding" href="#Breeze.MoistAirBuoyancies.MoistAirBuoyancy-Tuple{Any}"><code>Breeze.MoistAirBuoyancies.MoistAirBuoyancy</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">MoistAirBuoyancy(
    grid;
    base_pressure,
    reference_potential_temperature,
    thermodynamics
) -&gt; MoistAirBuoyancy{RS, AT} where {RS&lt;:(ReferenceState{_A, F} where {_A, F&lt;:(Field{Nothing, Nothing, Center, Nothing, G, I, D, T, B, Nothing} where {G, I, D, T, B})}), AT&lt;:ThermodynamicConstants}
</code></pre><p>Return a <code>MoistAirBuoyancy</code> formulation that can be provided as input to an <code>Oceananigans.NonhydrostaticModel</code>.</p><div class="admonition is-info" id="Required-tracers-f4b730f80781ba77"><header class="admonition-header">Required tracers<a class="admonition-anchor" href="#Required-tracers-f4b730f80781ba77" title="Permalink"></a></header><div class="admonition-body"><p><code>MoistAirBuoyancy</code> requires tracers <code>Œ∏</code> and <code>q·µó</code>.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Breeze, Oceananigans

grid = RectilinearGrid(size=(1, 1, 8), extent=(1, 1, 3e3))
buoyancy = MoistAirBuoyancy(grid)

# output
MoistAirBuoyancy:
‚îú‚îÄ‚îÄ reference_state: ReferenceState{Float64}(p‚ÇÄ=101325.0, Œ∏‚ÇÄ=288.0)
‚îî‚îÄ‚îÄ thermodynamics: ThermodynamicConstants{Float64}</code></pre><p>To build a model with <code>MoistAirBuoyancy</code>, we include potential temperature and total specific humidity tracers <code>Œ∏</code> and <code>q·µó</code> to the model.</p><pre><code class="language-julia hljs">model = NonhydrostaticModel(; grid, buoyancy, tracers = (:Œ∏, :q·µó))

# output
NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
‚îú‚îÄ‚îÄ grid: 1√ó1√ó8 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 1√ó1√ó3 halo
‚îú‚îÄ‚îÄ timestepper: RungeKutta3TimeStepper
‚îú‚îÄ‚îÄ advection scheme: Centered(order=2)
‚îú‚îÄ‚îÄ tracers: (Œ∏, q·µó)
‚îú‚îÄ‚îÄ closure: Nothing
‚îú‚îÄ‚îÄ buoyancy: MoistAirBuoyancy with gÃÇ = NegativeZDirection()
‚îî‚îÄ‚îÄ coriolis: Nothing</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/MoistAirBuoyancies.jl#L51">source</a></section></details></article><h3 id="AtmosphereModels"><a class="docs-heading-anchor" href="#AtmosphereModels">AtmosphereModels</a><a id="AtmosphereModels-1"></a><a class="docs-heading-anchor-permalink" href="#AtmosphereModels" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.AnelasticFormulation"><a class="docstring-binding" href="#Breeze.AtmosphereModels.AnelasticFormulation"><code>Breeze.AtmosphereModels.AnelasticFormulation</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p><code>AnelasticFormulation</code> is a dynamical formulation wherein the density and pressure are small perturbations from a dry, hydrostatic, adiabatic <code>reference_state</code>. The prognostic energy variable is the moist static energy density. The energy density equation includes a buoyancy flux term, following <a href="../references/#Pauluis2008">Pauluis (2008)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/anelastic_formulation.jl#L26">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.AtmosphereModel-Tuple{Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.AtmosphereModel-Tuple{Any}"><code>Breeze.AtmosphereModels.AtmosphereModel</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">AtmosphereModel(
    grid;
    clock,
    thermodynamics,
    formulation,
    moisture_density,
    tracers,
    coriolis,
    boundary_conditions,
    forcing,
    advection,
    closure,
    microphysics,
    timestepper
) -&gt; AtmosphereModel{Frm, Arc, Tst, Grd, Oceananigans.TimeSteppers.Clock{Float64, Float64, Int64, Int64}, Thm, Den, Mom, Eng, Mse, Moi, Mfr, Nothing, Tmp, Prs, Sol, Vel, Trc, Adv, Nothing, Frc, Nothing, @NamedTuple{}, Nothing, Nothing} where {Frm, Arc, Tst, Grd, Thm, Den, Mom, Eng, Mse, Moi, Mfr, Tmp, Prs, Sol, Vel, Trc, Adv, Frc}
</code></pre><p>Return an AtmosphereModel that uses the anelastic approximation following <a href="../references/#Pauluis2008">Pauluis (2008)</a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Breeze

julia&gt; grid = RectilinearGrid(size=(8, 8, 8), extent=(1, 2, 3));

julia&gt; model = AtmosphereModel(grid)
AtmosphereModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
‚îú‚îÄ‚îÄ grid: 8√ó8√ó8 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3√ó3√ó3 halo
‚îú‚îÄ‚îÄ formulation: AnelasticFormulation(p‚ÇÄ=101325.0, Œ∏‚ÇÄ=288.0)
‚îú‚îÄ‚îÄ timestepper: RungeKutta3TimeStepper
‚îú‚îÄ‚îÄ advection scheme: Centered(order=2)
‚îú‚îÄ‚îÄ tracers: ()
‚îú‚îÄ‚îÄ coriolis: Nothing
‚îî‚îÄ‚îÄ microphysics: Nothing</code></pre><p><strong>References</strong></p><p>Pauluis, O. (2008). Thermodynamic consistency of the anelastic approximation for a moist atmosphere.   Journal of the Atmospheric Sciences 65, 2719‚Äì2729.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/atmosphere_model.jl#L70-L99">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.AtmosphereModelBuoyancy"><a class="docstring-binding" href="#Breeze.AtmosphereModels.AtmosphereModelBuoyancy"><code>Breeze.AtmosphereModels.AtmosphereModelBuoyancy</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AtmosphereModelBuoyancy{F, T}</code></pre><p>Wrapper struct for computing buoyancy for AtmosphereModel in the context of a turbulence closure. Used to interface with Oceananigans turbulence closures that require buoyancy gradients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/atmosphere_model_buoyancy.jl#L5-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.PotentialTemperature-Tuple{Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.PotentialTemperature-Tuple{Any}"><code>Breeze.AtmosphereModels.PotentialTemperature</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">PotentialTemperature(
    model
) -&gt; KernelFunctionOperation{Center, Center, Center, _A, _B, K, Tuple{}} where {_A, _B, K&lt;:Breeze.AtmosphereModels.PotentialTemperatureKernelFunction}
</code></pre><p>Return a <code>KernelFunctionOperation</code> representing potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/diagnostic_fields.jl#L92-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.PotentialTemperatureField-Tuple{Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.PotentialTemperatureField-Tuple{Any}"><code>Breeze.AtmosphereModels.PotentialTemperatureField</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">PotentialTemperatureField(
    model
) -&gt; Field{LX, LY, LZ, O, G, I, D, T, B, Oceananigans.Fields.FieldStatus{Float64}} where {LX, LY, LZ, O, G, I, D, T, B}
</code></pre><p>Return a <code>Field</code> representing potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/diagnostic_fields.jl#L108-L112">source</a></section></details></article><h3 id="Microphysics"><a class="docs-heading-anchor" href="#Microphysics">Microphysics</a><a id="Microphysics-1"></a><a class="docs-heading-anchor-permalink" href="#Microphysics" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.BulkMicrophysics"><a class="docstring-binding" href="#Breeze.Microphysics.BulkMicrophysics"><code>Breeze.Microphysics.BulkMicrophysics</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">BulkMicrophysics(
;
    ...
) -&gt; BulkMicrophysics{N, Nothing} where N&lt;:(SaturationAdjustment{E} where E&lt;:MixedPhaseEquilibrium)
BulkMicrophysics(
    FT::DataType;
    categories,
    nucleation
) -&gt; BulkMicrophysics{N, Nothing} where N&lt;:(SaturationAdjustment{E} where E&lt;:MixedPhaseEquilibrium)
</code></pre><p>Return a <code>BulkMicrophysics</code> microphysics scheme with <code>clouds</code> and <code>precipitation</code> microphysics schemes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/bulk_microphysics.jl#L19-L23">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.MixedPhaseEquilibrium"><a class="docstring-binding" href="#Breeze.Microphysics.MixedPhaseEquilibrium"><code>Breeze.Microphysics.MixedPhaseEquilibrium</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">MixedPhaseEquilibrium(; ...) -&gt; MixedPhaseEquilibrium
MixedPhaseEquilibrium(
    FT;
    freezing_temperature,
    homogeneous_ice_nucleation_temperature
) -&gt; MixedPhaseEquilibrium
</code></pre><p>Return <code>MixedPhaseEquilibrium</code> representing a temperature-dependent equilibrium between water vapor, possibly supercooled liquid water, and ice.</p><p>The equilibrium state is modeled as a linear variation of the equilibrium liquid fraction with temperature, between the freezing temperature (e.g. 273.15 K) below which liquid water is supercooled, and the temperature of homogeneous ice nucleation temperature (e.g. 233.15 K) at which the supercooled liquid fraction vanishes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/saturation_adjustment.jl#L87">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.SaturationAdjustment"><a class="docstring-binding" href="#Breeze.Microphysics.SaturationAdjustment"><code>Breeze.Microphysics.SaturationAdjustment</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SaturationAdjustment(
;
    ...
) -&gt; SaturationAdjustment{E} where E&lt;:MixedPhaseEquilibrium
SaturationAdjustment(
    FT::DataType;
    tolerance,
    maxiter,
    equilibrium
) -&gt; SaturationAdjustment{E} where E&lt;:MixedPhaseEquilibrium
</code></pre><p>Return <code>SaturationAdjustment</code> microphysics representing an instantaneous adjustment to <code>equilibrium</code> between condensates and water vapor, computed by a solver with <code>tolerance</code> and <code>maxiter</code>.</p><p>The options for <code>equilibrium</code> are:</p><ul><li><p><a href="#Breeze.Microphysics.WarmPhaseEquilibrium"><code>WarmPhaseEquilibrium()</code></a> representing an equilibrium between water vapor and liquid water.</p></li><li><p><a href="#Breeze.Microphysics.MixedPhaseEquilibrium"><code>MixedPhaseEquilibrium()</code></a> representing a temperature-dependent equilibrium between water vapor, possibly supercooled liquid water, and ice. The equilibrium state is modeled as a linear variation of the equilibrium liquid fraction with temperature, between the freezing temperature (e.g. 273.15 K) below which liquid water is supercooled, and the temperature of homogeneous ice nucleation temperature (e.g. 233.15 K) at which the supercooled liquid fraction vanishes.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/saturation_adjustment.jl#L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.WarmPhaseEquilibrium"><a class="docstring-binding" href="#Breeze.Microphysics.WarmPhaseEquilibrium"><code>Breeze.Microphysics.WarmPhaseEquilibrium</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Return <code>WarmPhaseEquilibrium</code> representing an equilibrium between water vapor and liquid water.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/saturation_adjustment.jl#L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.adjust_thermodynamic_state-Tuple{Breeze.Thermodynamics.AbstractThermodynamicState, SaturationAdjustment, Any}"><a class="docstring-binding" href="#Breeze.Microphysics.adjust_thermodynamic_state-Tuple{Breeze.Thermodynamics.AbstractThermodynamicState, SaturationAdjustment, Any}"><code>Breeze.Microphysics.adjust_thermodynamic_state</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">adjust_thermodynamic_state(
    ùí∞‚ÇÄ::Breeze.Thermodynamics.AbstractThermodynamicState,
    microphysics::SaturationAdjustment,
    thermo
) -&gt; Breeze.Thermodynamics.AbstractThermodynamicState
</code></pre><p>Return the saturation-adjusted thermodynamic state using a secant iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/saturation_adjustment.jl#L211">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Microphysics.compute_temperature-Tuple{Any, SaturationAdjustment, Any}"><a class="docstring-binding" href="#Breeze.Microphysics.compute_temperature-Tuple{Any, SaturationAdjustment, Any}"><code>Breeze.Microphysics.compute_temperature</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_temperature(
    ùí∞‚ÇÄ,
    adjustment::SaturationAdjustment,
    thermo
) -&gt; Any
</code></pre><p>Perform saturation adjustment and return the temperature associated with the adjusted state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Microphysics/saturation_adjustment.jl#L270-L275">source</a></section></details></article><h3 id="TurbulenceClosures"><a class="docs-heading-anchor" href="#TurbulenceClosures">TurbulenceClosures</a><a id="TurbulenceClosures-1"></a><a class="docs-heading-anchor-permalink" href="#TurbulenceClosures" title="Permalink"></a></h3><h2 id="Private-API"><a class="docs-heading-anchor" href="#Private-API">Private API</a><a id="Private-API-1"></a><a class="docs-heading-anchor-permalink" href="#Private-API" title="Permalink"></a></h2><h3 id="Thermodynamics-2"><a class="docs-heading-anchor" href="#Thermodynamics-2">Thermodynamics</a><a class="docs-heading-anchor-permalink" href="#Thermodynamics-2" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.MoistureMassFractions"><a class="docstring-binding" href="#Breeze.Thermodynamics.MoistureMassFractions"><code>Breeze.Thermodynamics.MoistureMassFractions</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct MoistureMassFractions{FT}</code></pre><p>A struct representing the moisture mass fractions of a moist air parcel.</p><p><strong>Fields</strong></p><ul><li><code>vapor</code>: the mass fraction of vapor</li><li><code>liquid</code>: the mass fraction of liquid</li><li><code>ice</code>: the mass fraction of ice</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/thermodynamics_constants.jl#L197">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.PlanarMixedPhaseSurface"><a class="docstring-binding" href="#Breeze.Thermodynamics.PlanarMixedPhaseSurface"><code>Breeze.Thermodynamics.PlanarMixedPhaseSurface</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Return <code>PlanarMixedPhaseSurface</code> for computing the saturation vapor pressure over a surface composed of a mixture of liquid and ice, with a given <code>liquid_fraction</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/vapor_saturation.jl#L80">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.adiabatic_hydrostatic_density-NTuple{4, Any}"><a class="docstring-binding" href="#Breeze.Thermodynamics.adiabatic_hydrostatic_density-NTuple{4, Any}"><code>Breeze.Thermodynamics.adiabatic_hydrostatic_density</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">adiabatic_hydrostatic_density(z, p‚ÇÄ, Œ∏‚ÇÄ, thermo) -&gt; Any
</code></pre><p>Compute the reference density at height <code>z</code> that associated with the reference pressure and potential temperature <code>Œ∏‚ÇÄ</code>. The reference density is defined as the density of dry air at the reference pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/reference_states.jl#L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.adiabatic_hydrostatic_pressure-NTuple{4, Any}"><a class="docstring-binding" href="#Breeze.Thermodynamics.adiabatic_hydrostatic_pressure-NTuple{4, Any}"><code>Breeze.Thermodynamics.adiabatic_hydrostatic_pressure</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">adiabatic_hydrostatic_pressure(z, p‚ÇÄ, Œ∏‚ÇÄ, thermo) -&gt; Any
</code></pre><p>Compute the reference pressure at height <code>z</code> that associated with the reference pressure <code>p‚ÇÄ</code> and potential temperature <code>Œ∏‚ÇÄ</code>. The reference pressure is defined as the pressure of dry air at the reference pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/reference_states.jl#L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.saturation_specific_humidity-NTuple{4, Any}"><a class="docstring-binding" href="#Breeze.Thermodynamics.saturation_specific_humidity-NTuple{4, Any}"><code>Breeze.Thermodynamics.saturation_specific_humidity</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">saturation_specific_humidity(T, œÅ, thermo, surface) -&gt; Any
</code></pre><p>Compute the saturation specific humidity for a gas at temperature <code>T</code>, total density <code>œÅ</code>, <code>thermo</code>dynamics, and over <code>surface</code> via:</p><p class="math-container">\[q·µõ‚Å∫ = p·µõ‚Å∫ / (œÅ R·µõ T) ,\]</p><p>where <span>$p·µõ‚Å∫$</span> is the <a href="#Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, Any}"><code>saturation_vapor_pressure</code></a> over <code>surface</code>, <span>$œÅ$</span> is total density, and <span>$R·µõ$</span> is the specific gas constant for water vapor.</p><p><strong>Examples</strong></p><p>First we compute the saturation specific humidity over a liquid surface:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: PlanarLiquidSurface, PlanarIceSurface, PlanarMixedPhaseSurface

thermo = ThermodynamicConstants()
T = 288.0 # Room temperature (K)
p = 101325.0 # Mean sea-level pressure
R·µà = Breeze.Thermodynamics.dry_air_gas_constant(thermo)
q = zero(Breeze.Thermodynamics.MoistureMassFractions{Float64})
œÅ = Breeze.Thermodynamics.density(p, T, q, thermo)
q·µõ‚Å∫À° = Breeze.Thermodynamics.saturation_specific_humidity(T, œÅ, thermo, PlanarLiquidSurface())

# output
0.010359995391195264</code></pre><p>Note, this is slightly smaller than the saturation specific humidity over an ice surface:</p><pre><code class="language-julia-repl hljs">julia&gt; q·µõ‚Å∫À° = Breeze.Thermodynamics.saturation_specific_humidity(T, œÅ, thermo, PlanarIceSurface())
0.011945100768555072</code></pre><p>If a medium contains a mixture of 40% water and 60% ice that has (somehow) acquired thermodynamic equilibrium, we can compute the saturation specific humidity over the mixed phase surface,</p><pre><code class="language-julia hljs">mixed_surface = PlanarMixedPhaseSurface(0.4)
q·µõ‚Å∫·µê = Breeze.Thermodynamics.saturation_specific_humidity(T, œÅ, thermo, mixed_surface)

# output
0.01128386068542303</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/vapor_saturation.jl#L109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, Any}"><code>Breeze.Thermodynamics.saturation_vapor_pressure</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(T, thermo, surface) -&gt; Any
</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Vapor_pressure">saturation vapor pressure</a> <span>$p·µõ‚Å∫$</span> over a surface labeled <span>$Œ≤$</span> (for example, a planar liquid surface, or curved ice surface) using the Clausius-Clapeyron relation,</p><p class="math-container">\[ùñΩp·µõ‚Å∫ / ùñΩT = p·µõ‚Å∫ ‚Ñí·µù(T) / (R·µõ T^2) ,\]</p><p>where the temperature-dependent latent heat of the surface is <span>$‚Ñí·µù(T)$</span>.</p><p>Using a model for the latent heat that is linear in temperature, eg</p><p class="math-container">\[‚Ñí·µù = ‚Ñí·µù‚ÇÄ + Œîc·µù T,\]</p><p>where <span>$‚Ñí·µù‚ÇÄ ‚â° ‚Ñí·µù(T=0)$</span> is the latent heat at absolute zero and <span>$Œîc·µù ‚â° c·µñ·µõ - c·µù$</span>  is the constant difference between the vapor specific heat and the specific heat of phase <span>$Œ≤$</span>.</p><p>Note that we typically parameterize the latent heat in terms of a reference temperature <span>$T = T·µ£$</span> that is well above absolute zero. In that case, the latent heat is written</p><p class="math-container">\[‚Ñí·µù = ‚Ñí·µù·µ£ + Œîc·µù (T - T·µ£),
\qquad \text{and} \qquad
‚Ñí·µù‚ÇÄ = ‚Ñí·µù·µ£ - Œîc·µù T·µ£ .\]</p><p>Integrating the Clausius-Clapeyron relation with a temperature-linear latent heat model, from the triple point pressure and temperature <span>$(p·µó ≥, T·µó ≥)$</span> to pressure <span>$p·µõ‚Å∫$</span> and temperature <span>$T$</span>, we obtain</p><p class="math-container">\[\log(p·µõ‚Å∫ / p·µó ≥) = - ‚Ñí·µù‚ÇÄ / (R·µõ T) + ‚Ñí·µù‚ÇÄ / (R·µõ T·µó ≥) + \log \left[ (Œîc·µù / R·µõ) (T / T·µó ≥) \right] ,\]</p><p>which then becomes</p><p class="math-container">\[p·µõ‚Å∫(T) = p·µó ≥ (T / T·µó ≥)^{Œîc·µù / R·µõ} \exp \left [ (1/T·µó ≥ - 1/T) ‚Ñí·µù‚ÇÄ / R·µõ \right ] .\]</p><div class="admonition is-info" id="Note-4de2541e0a79a485"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4de2541e0a79a485" title="Permalink"></a></header><div class="admonition-body"><p>Any reference values for pressure and temperature can be used in principle. The advantage of using reference values at the triple point is that the same values can then be used for both condensation (vapor ‚Üí liquid) and deposition (vapor ‚Üí ice).</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/Thermodynamics/vapor_saturation.jl#L1">source</a></section></details></article><h3 id="MoistAirBuoyancies-2"><a class="docs-heading-anchor" href="#MoistAirBuoyancies-2">MoistAirBuoyancies</a><a class="docs-heading-anchor-permalink" href="#MoistAirBuoyancies-2" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.MoistAirBuoyancies.compute_boussinesq_adjustment_temperature-Union{Tuple{FT}, Tuple{Breeze.Thermodynamics.PotentialTemperatureState{FT}, Any}} where FT"><a class="docstring-binding" href="#Breeze.MoistAirBuoyancies.compute_boussinesq_adjustment_temperature-Union{Tuple{FT}, Tuple{Breeze.Thermodynamics.PotentialTemperatureState{FT}, Any}} where FT"><code>Breeze.MoistAirBuoyancies.compute_boussinesq_adjustment_temperature</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_boussinesq_adjustment_temperature(
    ùí∞‚ÇÄ::Breeze.Thermodynamics.PotentialTemperatureState{FT},
    thermo
) -&gt; Any
</code></pre><p>Return the temperature <span>$T$</span> corresponding to thermodynamic equilibrium between the specific humidity and liquid mass fractions of the input thermodynamic state <code>ùí∞‚ÇÄ</code>, wherein the specific humidity is equal to or less than the saturation specific humidity at the given conditions and affiliated with theromdynamic constants <code>thermo</code>.</p><p>The saturation equilibrium temperature satisfies the nonlinear relation</p><p class="math-container">\[Œ∏ = [1 - ‚ÑíÀ°·µ£ qÀ° / (c·µñ·µê T)] T / Œ† ,\]</p><p>with <span>$‚ÑíÀ°·µ£$</span> the latent heat at the reference temperature <span>$T·µ£$</span>, <span>$c·µñ·µê$</span> the mixture specific heat, <span>$Œ†$</span> the Exner function, <span>$qÀ° = \max(0, q·µó - q·µõ‚Å∫)$</span> the condensate specific humidity, <span>$q·µó$</span> is the total specific humidity, and <span>$q·µõ‚Å∫$</span> is the saturation specific humidity.</p><p>The saturation equilibrium temperature is thus obtained by solving <span>$r(T) = 0$</span>, where</p><p class="math-container">\[r(T) ‚â° T - Œ∏ Œ† - ‚ÑíÀ°·µ£ qÀ° / c·µñ·µê .\]</p><p>Solution of <span>$r(T) = 0$</span> is found via the <a href="https://en.wikipedia.org/wiki/Secant_method">secant method</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/MoistAirBuoyancies.jl#L154">source</a></section></details></article><h3 id="AtmosphereModels-2"><a class="docs-heading-anchor" href="#AtmosphereModels-2">AtmosphereModels</a><a class="docs-heading-anchor-permalink" href="#AtmosphereModels-2" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.PotentialTemperatureKernelFunction"><a class="docstring-binding" href="#Breeze.AtmosphereModels.PotentialTemperatureKernelFunction"><code>Breeze.AtmosphereModels.PotentialTemperatureKernelFunction</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PotentialTemperatureKernel(temperature)</code></pre><p>A callable object for diagnosing the potential temperature field, given a temperature field, designed for use as a <code>KernelFunctionOperation</code> in Oceananigans. Follows the pattern used for saturation diagnostics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/diagnostic_fields.jl#L65-L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.SaturationSpecificHumidityField-Tuple{Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.SaturationSpecificHumidityField-Tuple{Any}"><code>Breeze.AtmosphereModels.SaturationSpecificHumidityField</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">SaturationSpecificHumidityField(
    model
) -&gt; Field{LX, LY, LZ, O, G, I, D, T, B, Oceananigans.Fields.FieldStatus{Float64}} where {LX, LY, LZ, O, G, I, D, T, B}
</code></pre><p>Return a field for the saturation specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/diagnostic_fields.jl#L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.SaturationSpecificHumidityKernelFunction"><a class="docstring-binding" href="#Breeze.AtmosphereModels.SaturationSpecificHumidityKernelFunction"><code>Breeze.AtmosphereModels.SaturationSpecificHumidityKernelFunction</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SaturationSpecificHumidityKernel(temperature)</code></pre><p>A callable object for diagnosing the saturation specific humidity field, given a temperature field, designed for use as a <code>KernelFunctionOperation</code> in Oceananigans. Parameters are captured within the kernel struct for GPU friendliness.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/diagnostic_fields.jl#L6-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.adjust_thermodynamic_state-Tuple{Any, Nothing, Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.adjust_thermodynamic_state-Tuple{Any, Nothing, Any}"><code>Breeze.AtmosphereModels.adjust_thermodynamic_state</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">adjust_thermodynamic_state(
    state,
    scheme::Nothing,
    thermo
) -&gt; Any
</code></pre><p>Adjust the thermodynamic <code>state</code> according to the <code>scheme</code>. For example, if <code>scheme isa SaturationAdjustment</code>, then this function will adjust and return a new thermodynamic state given the specifications of the saturation adjustment <code>scheme</code>.</p><p>If a scheme is non-adjusting, we just return <code>state</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L79-L88">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.compute_auxiliary_variables!-Tuple{Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.compute_auxiliary_variables!-Tuple{Any}"><code>Breeze.AtmosphereModels.compute_auxiliary_variables!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_auxiliary_variables!(model)
</code></pre><p>Compute auxiliary model variables:</p><ul><li><p>velocities from momentum and density (eg <span>$u = œÅu / œÅ$</span>)</p></li><li><p>thermodynamic variables from the prognostic thermodynamic state,</p><ul><li>temperature <span>$T$</span>, possibly involving saturation adjustment</li><li>moist static energy <span>$e = œÅe / œÅ$</span></li><li>moisture mass fraction <span>$q·µó = œÅq·µó / œÅ$</span></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/update_atmosphere_model_state.jl#L23-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.compute_moisture_fractions-Tuple{Any, Any, Any, Any, Nothing, Any, Any, Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.compute_moisture_fractions-Tuple{Any, Any, Any, Any, Nothing, Any, Any, Any}"><code>Breeze.AtmosphereModels.compute_moisture_fractions</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_moisture_fractions(
    i,
    j,
    k,
    grid,
    microphysics::Nothing,
    œÅ,
    q·µó,
    Œº
) -&gt; Breeze.Thermodynamics.MoistureMassFractions
</code></pre><p>Build and return <a href="#Breeze.Thermodynamics.MoistureMassFractions"><code>MoistureMassFractions</code></a> at <code>(i, j, k)</code> for the given <code>grid</code>, <code>microphysics</code>, <code>microphysical_fields</code>, and total moisture mass fraction <code>q·µó</code>.</p><p>Dispatch is provided for <code>::Nothing</code> microphysics here. Specific microphysics schemes may extend this method to provide tailored behavior.</p><p>Note: while œÅ and q·µó are scalars, the microphysical fields <code>Œº</code> are <code>NamedTuple</code> of <code>Field</code>. This may be changed in the future.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L47">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.diagnose_thermodynamic_state-Tuple{Any, Any, Any, Any, AnelasticFormulation, Vararg{Any, 5}}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.diagnose_thermodynamic_state-Tuple{Any, Any, Any, Any, AnelasticFormulation, Vararg{Any, 5}}"><code>Breeze.AtmosphereModels.diagnose_thermodynamic_state</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">diagnose_thermodynamic_state(
    i,
    j,
    k,
    grid,
    formulation::AnelasticFormulation,
    microphysics,
    microphysical_fields,
    thermo,
    energy_density,
    moisture_density
) -&gt; Breeze.Thermodynamics.MoistStaticEnergyState
</code></pre><p>Return <code>MoistStaticEnergyState</code> computed from the prognostic state including energy density, moisture density, and microphysical fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/anelastic_formulation.jl#L56-L61">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.materialize_microphysical_fields-Tuple{Nothing, Any, Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.materialize_microphysical_fields-Tuple{Nothing, Any, Any}"><code>Breeze.AtmosphereModels.materialize_microphysical_fields</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">materialize_microphysical_fields(
    microphysics::Nothing,
    grid,
    boundary_conditions
) -&gt; @NamedTuple{}
</code></pre><p>Build microphysical fields associated with <code>microphysics</code> on <code>grid</code> and with user defined <code>boundary_conditions</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.maybe_adjust_thermodynamic_state-Tuple{Any, Nothing, Any, Any, Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.maybe_adjust_thermodynamic_state-Tuple{Any, Nothing, Any, Any, Any}"><code>Breeze.AtmosphereModels.maybe_adjust_thermodynamic_state</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">maybe_adjust_thermodynamic_state(
    state,
    _::Nothing,
    microphysical_fields,
    q·µó,
    thermo
) -&gt; Any
</code></pre><p>Possibly apply saturation adjustment. If a <code>microphysics</code> scheme does not invoke saturation adjustment, just return the <code>state</code> unmodified. In contrast to <code>adjust_thermodynamic_state</code>, this function ingests the entire <code>microphysics</code> formulation and the <code>microphysical_fields</code>. This is needed because some microphysics schemes apply saturation adjustment to a subset of the thermodynamic state (for example, omitting precipitating species).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L13-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.microphysical_tendency-Tuple{Any, Any, Any, Any, Nothing, Any, Vararg{Any}}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.microphysical_tendency-Tuple{Any, Any, Any, Any, Nothing, Any, Vararg{Any}}"><code>Breeze.AtmosphereModels.microphysical_tendency</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">microphysical_tendency(
    i,
    j,
    k,
    grid,
    microphysics::Nothing,
    name,
    args...
) -&gt; Any
</code></pre><p>Return the tendency of the microphysical field <code>name</code> associated with <code>microphysics</code> and <code>thermo</code>dynamic constants.</p><p>TODO: add the function signature when it is stable</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L70">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.microphysical_velocities-Tuple{Nothing, Any}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.microphysical_velocities-Tuple{Nothing, Any}"><code>Breeze.AtmosphereModels.microphysical_velocities</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">microphysical_velocities(microphysics::Nothing, name)
</code></pre><p>Return the microphysical velocities associated with <code>microphysics</code> and <code>name</code>.</p><p>Must be either <code>nothing</code>, or a NamedTuple with three components <code>u, v, w</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L61">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.prognostic_field_names-Tuple{Nothing}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.prognostic_field_names-Tuple{Nothing}"><code>Breeze.AtmosphereModels.prognostic_field_names</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prognostic_field_names(_::Nothing) -&gt; Tuple{}
</code></pre><p>Return <code>tuple()</code> - zero-moment scheme has no prognostic variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.update_microphysical_fields!-Tuple{Any, Nothing, Vararg{Any, 7}}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.update_microphysical_fields!-Tuple{Any, Nothing, Vararg{Any, 7}}"><code>Breeze.AtmosphereModels.update_microphysical_fields!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">update_microphysical_fields!(
    microphysical_fields,
    microphysics::Nothing,
    i,
    j,
    k,
    grid,
    density,
    state,
    thermo
)
</code></pre><p>Update microphysical fields for <code>microphysics_scheme</code> given the thermodynamic <code>state</code> and <code>thermo</code>dynamic parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/microphysics_interface.jl#L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Breeze.AtmosphereModels.‚àá_dot_J·∂ú-Tuple{Any, Any, Any, Any, Vararg{Any}}"><a class="docstring-binding" href="#Breeze.AtmosphereModels.‚àá_dot_J·∂ú-Tuple{Any, Any, Any, Any, Vararg{Any}}"><code>Breeze.AtmosphereModels.‚àá_dot_J·∂ú</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">‚àá_dot_J·∂ú(i, j, k, grid, density, closure::AbstractTurbulenceClosure, closure_fields,
         id, c, clock, model_fields, buoyancy)</code></pre><p>Return the discrete divergence of the dynamic scalar flux <code>J·∂ú = œÅ j·∂ú</code>, where <code>j·∂ú</code> is the &quot;kinematic scalar flux&quot;, using area-weighted differences divided by cell volume. Similar to Oceananigans&#39; <code>‚àá_dot_q·∂ú</code> signature with the additional density factor <code>œÅ</code>, where in Oceananigans <code>q·∂ú</code> is the kinematic tracer flux.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/dynamics_kernel_functions.jl#L10-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Oceananigans.TimeSteppers.compute_flux_bc_tendencies!-Tuple{AtmosphereModel}"><a class="docstring-binding" href="#Oceananigans.TimeSteppers.compute_flux_bc_tendencies!-Tuple{AtmosphereModel}"><code>Oceananigans.TimeSteppers.compute_flux_bc_tendencies!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_flux_bc_tendencies!(model::AtmosphereModel)
</code></pre><p>Apply boundary conditions by adding flux divergences to the right-hand-side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/update_atmosphere_model_state.jl#L270">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Oceananigans.TimeSteppers.make_pressure_correction!-Tuple{AtmosphereModel{&lt;:AnelasticFormulation}, Any}"><a class="docstring-binding" href="#Oceananigans.TimeSteppers.make_pressure_correction!-Tuple{AtmosphereModel{&lt;:AnelasticFormulation}, Any}"><code>Oceananigans.TimeSteppers.make_pressure_correction!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">make_pressure_correction!(
    model::AtmosphereModel{&lt;:AnelasticFormulation},
    Œît
)
</code></pre><p>Update the predictor momentum <span>$(œÅu, œÅv, œÅw)$</span> with the non-hydrostatic pressure via</p><p class="math-container">\[(\rho\boldsymbol{u})^{n+1} = (\rho\boldsymbol{u})^n - \Delta t \, \rho_r \boldsymbol{\nabla} \left( \alpha_r p_{nh} \right)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/71a4ae2034a7e1c2203ab81d6f27dca2feeec553/src/AtmosphereModels/anelastic_formulation.jl#L279">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../references/">¬´ References</a><a class="docs-footer-nextpage" href="../contributing/">Contributors guide ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 27 November 2025 05:21">Thursday 27 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
